!function(){function e(e){fetch("https://split.esensigroup.com/tracker-api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).then(e=>console.log("Success:",e)).catch(e=>console.error("Error:",e))}document.addEventListener("DOMContentLoaded",function(){!function e(){var t=window.location.origin;let n="baseUrl_viewDataSent";if(t=(t=t.replace(/^https?:\/\//,"")).replace(/^www\./,""),sessionStorage.getItem(n))console.log("View data already sent for the base URL in this session.");else{let o={slug:t,token:token};(function e(t){fetch("https://split.esensigroup.com/base-view-api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>e.json()).then(e=>console.log("Success:",e)).catch(e=>console.error("Error:",e))})(o),sessionStorage.setItem(n,"true")}}(),function e(){let t=window.location.host+window.location.pathname,n=dataMapping.find(e=>t.includes(e.slug));if(n){console.log("Matching URL found:",n.slug);let o=`${n.slug}_viewDataSent`;if(sessionStorage.getItem(o))console.log("View data already sent for this user in this session.");else{let s={slug:n.slug,token:token};(function e(t){fetch("https://split.esensigroup.com/view-api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>e.json()).then(e=>console.log("Success:",e)).catch(e=>console.error("Error:",e))})(s),sessionStorage.setItem(o,"true")}}else console.log("No matching URL found.")}(),dataMapping.forEach(({selector:t,variant:n,slug:o})=>{let s=document.querySelectorAll(t);s.forEach(s=>{let i=!1;s.addEventListener("click",function(){let l=window.location.host+window.location.pathname;if(l.includes(o)){let a={url:l,selector:t,variant:n,token:token};"FORM"===s.tagName?s.addEventListener("submit",function(t){t.preventDefault(),i?console.log("Form already submitted."):(i=!0,e(a))}):i?console.log("Button already clicked."):(i=!0,e(a))}else console.log("Current URL does not match slug:",o)})})}),setTimeout(function(){if(sessionStorage.getItem("hasRedirected"))return;let e=dataMapping[Math.floor(Math.random()*dataMapping.length)],t=localStorage.getItem(e.slug+"_hits")?parseInt(localStorage.getItem(e.slug+"_hits")):0;t++,localStorage.setItem(e.slug+"_hits",t),sessionStorage.setItem("hasRedirected","true");let n=window.location.origin;window.location.href=n+"/"+e.slug},2e3)})}();
